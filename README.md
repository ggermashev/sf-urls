# Проект "Сервис коротких ссылок"

## Как пользоваться сервисом

При запуске приложения в терминале появляется меню. 
При выборе пункта меню в терминале выводится дополнительная 
информация, какие данные необходимо ввести пользователю и
в каком формате.

## Какие команды поддерживаются

- Создать аккаунт 
- Войти в аккаунт 
- Выйти из аккаунта 
- Создать короткую ссылку 
- Перейти по короткой ссылке 
- Редактировать параметры короткой ссылки 
- Удалить короткую ссылку 
- Выход из приложения

## Как протестировать код

Все тесты запускаются из [Tester](./src/Tester.java)

## Основные задачи

### Создание коротких ссылок

При соответствующем запросе происходит генерация короткой ссылки и ее сохранение в БД
в виде сущности [UrlModel](./src/Models/UrlModel.java). 

Логика создания короткой ссылки находится в [UrlController](./src/Controllers/UrlController.java)

### Уникальные ссылки для каждого пользователя

Всегда, при любых условиях, генерируется уникальная ссылка.
Реализовано в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Лимит переходов

При создании короткой ссылки передается лимит переходов по ней.
Реализацию можно посмотреть в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Ограничение времени жизни ссылки

При создании короткой ссылки сохраняется время ее инициализации.
При использовании короткой ссылки проверяется время, которое прошло с момента ее инициализации.
Реализацию можно посмотреть в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Уведомление пользователя, если ссылка больше не действительна

Если лимит переходов по ссылке превышен, или время работы ссылки истекло,
выбрасывается соответствующая ошибка, в результате чего пользователь получает сообщение
в терминале. 

### Идентификация пользователя по UUID

Предусмотрен функционал создания аккаунта, в результате чего пользователь получает
свой уникальный UUID. Далее, используя полученный UUID, пользователь
может идентифицироваться. 

## Реализация основных функций

### Сокращение ссылки

При соответствующем запросе происходит генерация короткой ссылки и ее сохранение в БД
в виде сущности [UrlModel](./src/Models/UrlModel.java).

Логика создания короткой ссылки находится в [UrlController](./src/Controllers/UrlController.java).

### Лимит переходов

При создании короткой ссылки передается лимит переходов по ней.
Реализацию можно посмотреть в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java)

### Время жизни ссылки

При создании короткой ссылки сохраняется время ее инициализации.
При использовании короткой ссылки проверяется время, которое прошло с момента ее инициализации.
Реализацию можно посмотреть в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java)

### Идентификация пользователя

Предусмотрен функционал создания аккаунта, в результате чего пользователь получает
свой уникальный UUID. Далее, используя полученный UUID, пользователь
может идентифицироваться.

### Переход по короткой ссылке

Реализован метод, который принимает короткую ссылку, а затем по ней находит оригинальную.
При этом производятся проверки на число переходов по ссылке и время ее жизни.

Реализацию можно посмотреть в [UrlController](./src/Controllers/UrlController.java)
и в [UrlModel](./src/Models/UrlModel.java)

## Тестирование системы

- Для разных пользователей генерируются уникальные короткие ссылки
- При исчерпании лимита переходов ссылка блокируется
- Удаление ссылок по истечении срока жизни
- Получение уведомления в случае недоступности ссылки
- Валидация параметров ссылки
- Удаление ссылки
- Редактирование ссылки
- Проверка наличия прав для работы со ссылкой

Перечисленные выше тесткейсы можно посмотреть [здесь](./src/Controllers/ControllerTester.java)

## Критерии оценивания

### Функциональность

Весь функционал покрыт [тестами](./src/Controllers/ControllerTester.java)

### Внесение основных параметров работы алгоритма в конфигурационный файл

### Ограничение по времени жизни

При создании короткой ссылки сохраняется время ее инициализации.
При использовании короткой ссылки проверяется время, которое прошло с момента ее инициализации.
Реализацию можно посмотреть в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java)

### Автоматическое удаление ссылок

В случае, если время работы ссылки истекло, в результате обращения к ней она будет удалена.
Реализация находится в [UrlController](./src/Controllers/UrlController.java).

### Уникальность ссылки

Всегда, при любых условиях, генерируется уникальная ссылка.
Реализовано в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Повторное создание ссылок

Всегда, при любых условиях, генерируется уникальная ссылка.
Реализовано в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Переход по ссылке

Реализован метод, который принимает короткую ссылку, а затем по ней находит оригинальную.
При этом производятся проверки на число переходов по ссылке и время ее жизни.

Реализацию можно посмотреть в [UrlController](./src/Controllers/UrlController.java)
и в [UrlModel](./src/Models/UrlModel.java)

### Лимит переходов

При создании короткой ссылки передается лимит переходов по ней.
Реализацию можно посмотреть в [UrlModel](./src/Models/UrlModel.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java)

### Уведомление пользователя

При возникновении ошибок пользователь уведомляется в результате
выброса соответствующих [исключений](./src/Exceptions).

### Редактирование лимита переходов

Редактирование параметров ссылки реализовано в [UrlController](./src/Controllers/UrlController.java).
Также при редактировании проверяется, что текущий пользователь является владельцем ссылки.

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Удаление ссылки

Удаление ссылки реализовано в [UrlController](./src/Controllers/UrlController.java).
Также при удалении проверяется, что текущий пользователь является владельцем ссылки.

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Идентификация по UUID

Предусмотрен функционал создания аккаунта, в результате чего пользователь получает
свой уникальный UUID. Далее, используя полученный UUID, пользователь
может идентифицироваться.

Реализацию работы с пользователями можно посмотреть в [UserModel](./src/Models/UserModel.java) и
[UserController](./src/Controllers/UserController.java).

### Работа нескольких пользователей

Предусмотрен функционал создания аккаунта, в результате чего пользователь получает
свой уникальный UUID. Далее, используя полученный UUID, пользователь
может идентифицироваться.

Реализацию работы с пользователями можно посмотреть в [UserModel](./src/Models/UserModel.java) и [UserController](./src/Controllers/UserController.java).

### Администрирование параметров ссылки

Проверка на то, что только создатель ссылки может редактировать ее параметры и удалять ее
реализована в соответствующих методах [UrlController](./src/Controllers/UrlController.java).

Если текущий пользователь не является владельцем ссылки - выбрасывается исключение
[NotLinkOwnerException](./src/Exceptions/NotLinkOwnerException.java).

Тесткейс можно найти в [ControllerTester](./src/Controllers/ControllerTester.java).

### Создание нескольких ссылок

Все созданные пользователем ссылки хранятся в [самостоятельно реализованном аналоге базы данных](./src/Database).
Следовательно, поддерживается функционал создания нескольких ссылок.
Стоит отметить, что при старте программы, данные подгружаются из [TablesStorage](./src/TablesStorage)
А при завершении работы, данные из БД выгружаются в эту же директорию.
Функционал реализован с помощью [FileManager](./src/utils/FileManager.java)

### Идентификация по UUID при повторных запросах

Когда пользователь входит в аккаунт по своему id, клиентская часть приложения получает токен доступа, который был
сгенерирован на серверной части приложения. По этому токену доступа происходи идентификация при повторных запросах,
пока пользователь остается идентифицированным. При выходе из аккаунта, токен доступа "протухает". Стоит отметить, что
<id аккаунта> != <токен доступа>, поэтому пользователь снова имеет возможность идентифицироваться по тому же id,
но клиентская часть приложения получит уже новый токен доступа, который будет использоваться при запросах. 